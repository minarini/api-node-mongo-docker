  version: '3.8'

  services:
    app:
      build:
        context: .
        dockerfile: Dockerfile
      container_name: ecopontos-app
      restart: unless-stopped
      ports:
        - "3000:3000"
      environment:
        - NODE_ENV=${NODE_ENV:-development}
        - PORT=3000
        - MONGO_URL=${MONGO_URL}
      networks:
        - ecopontos-network
      healthcheck:
        test: ["CMD", "node", "-e", "require('http').get('http://localhost:3000/', (r) => {process.exit(r.statusCode === 200 ? 0 : 1)})"]
        interval: 30s
        timeout: 10s
        retries: 3
        start_period: 40s

  # Rede interna para comunicação entre containers
  networks:
    ecopontos-network:
      driver: bridge

  # Volumes para persistência de dados
  volumes:
    mongodb_data:
      driver: local

